# BPU

## 概述

### 组成

BPU单元由 PHT、BTB、RAS 三部分组成。
- PHT: 2位饱和计数器
- BTB: 地址cache，采用直接映射结构
- RAS: 返回地址堆栈, 存储间接跳转目的地址

BPU从IF阶段获取指令组的第一条pc，读取返回下一周期的取指令pc，为组合逻辑。
BPU从EXM(EXE)阶段获取跳转指令的跳转情况和跳转目的，对PHT和BTB进行写入，为时序逻辑。

### 接口

- | Input/Output | 名称          | 作用                                             |
    | ------------ | ------------- | ------------------------------------------------ |
    | I            | clk           | 时钟信号                                         |
    | I            | reset         | 复位信号                                         |
    | I            | pc            | if段当前周期的取指地址                             |
    | O            | next_pc       | 给if段的下条指令地址                               |
    | O            | pc_is_jump    | 指令组中每条指令是否发生跳转，高电平有效               |
    | O            | pc_valid      | 指令组中每条指令是否有效，高电平有效                  |
    | I            | bpu_es_bus1   | EXM1阶段的写入BPU的指令数据，包括指令地址，跳转类型，跳转目的地址 |
    | I            | bpu_es_bus2   | EXM1阶段的写入BPU的指令数据，包括指令地址，跳转类型，跳转目的地址 |