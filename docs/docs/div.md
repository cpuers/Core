

### 除法器模块设计

|  接口           |      简介     |
|----------------|--------------|
|div_clk         |    系统时钟   |
|  reset         |    清空       |
|    div         |   使能信号    |
|div_signed      | 带有符号除法  |
|x[31:0]         |   被除数      |
|y[31:0]         |    除数      |
|use_mod         |    计算余数   |
|div_result[31:0]|    运算结果   |
|div_ok          |   计算结束信号|


#### 算法：基2-SRT

基于综合性能和速度的考量，较大的查找QDS可能会造成性能上的浪费以及正确性上的不稳定，于是我们采用了基2-SRT除法算法，在这种算法中，商有$-1$,$0$,$1$三种选择，根据被除数的前两位可以快速进行商的选择，避免了传统除法器中冗余的比较操作和选择操作，同时允许在除法运算中快速跳过无用的连续$1$或者连续$0$。

- 基2QDS

| $S_i$ $S_{i-1}$ |  $Q_i$  | 对$S$的操作 |
|-----------------|---------|------------|
|  $11$  |  $0$  |    无   |
|  $00$  |  $0$  |    无   |
|  $10$  |  $-1$  |  $+ D$  |
|  $01$  |  $1$  |  $- D$  |


因为最后的商中可能存在值为$-1$的位，因此需要转化：也就是on-the-fly converting，在计算之后可以实时更新余数。考虑到减小模块复杂度，在本模块中只是简单的分成了`posQ`和`negQ`并在最后求和。

最后是商和余数的修正。若余数为负，也需要再加上一个除数进行符号修正，同时对于商，也要加上`ulp`进行精度调正，此处`ulp`应为余数的符号位，

在流水线的设计上，第一个周期会进行额外的正规化操作，具体实现就是去除前导0，实现位数对齐，以及将有符号除法转化为无符号除法。
